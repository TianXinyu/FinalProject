# things I can do in my data

# to see how many people are not in labor force (dichotomous variables)
#table(PRData$LABFORCE)
# to test if it's significant
#distribution=table(PRData$LABFORCE)
#chisq.test(distribution) # notice the the input is a table
# to clean the NA, and only keep people from 25-65
#symbolsForNA=c('â€ ') # you can put here the symbols you want to convert to NA
#schoolPub[-1]=lapply(schoolPub[-1],
                 #function(x) 
                   #replace(x,x%in%symbolsForNA, NA))
#table(schoolPub$Title.1.School.Wide.)



# to see the age distribution (polytomous variables)
# central value

# To see the relationship between 2 variables: use bivariate case
## here i want to see the relationship between age and labforce, 
## which is categorical-numerical

# I want to see which variable affects the laborforce most, so I can use clustering/PCA tech.
# I can set levles on age (25-35,35-45,45-55,55-65)
# If i want to make a map, i need to merge extra data


```{r}
# get the data from github
dataURL <- "https://raw.githubusercontent.com/TianXinyu/FinalProject/master/usa_00001.csv"

# https://github.com/TianXinyu/FinalProject/raw/master/usa_00001.csv

# https://github.com/TianXinyu/FinalProject/blob/master/usa_00001.csv?raw=true
data <- read.csv(dataURL)
class(data)
```

```{r}
names(data)
str(data)
```

```{r}
# I dont need detailed race and classofwork

datanew=data[,c("AGE","LABFORCE","DIFFPHYS" ,"DIFFMOB" , "DIFFCARE" ,"DIFFSENS", "DIFFEYE" , "DIFFHEAR","RACE")]
head(datanew)
```

make age a numerical variable
```{r}
datanew$AGE=as.numeric(datanew$AGE)
str(datanew$AGE)
```


```{r}
# keep people from 25-65
datanew=datanew[datanew$AGE>=25 & datanew$AGE<=65, ]
str(datanew)
```


```{r}
# 0 is not in lbfc, 1 is in lbfc
datanew$LABFORCE=as.numeric(datanew$LABFORCE)
datanew$lbfc[datanew$LABFORCE==1] <- 0
datanew$lbfc[datanew$LABFORCE==2] <- 1
str(datanew)
```

```{r}
# combine the diseases column together
Disease <- rep_len(0, length.out=nrow(datanew))
datanew <- cbind(datanew, Disease)
datanew$Disease <- datanew$Disease[datanew$DIFFPHYS==1 & datanew$DIFFCARE==1 & datanew$DIFFMOB==1 & datanew$DIFFSENS==1 & datanew$DIFFEYE==1 & datanew$DIFFHEAR==1] <-0
datanew$Disease[datanew$DIFFPHYS==2 | datanew$DIFFCARE==2 | datanew$DIFFMOB==2 |  datanew$DIFFSENS==2 | datanew$DIFFEYE==2 |  datanew$DIFFHEAR==2] <-1
str(datanew)
```

```{r}
# Get the final dataset
datafinal=datanew[,c("AGE","lbfc","Disease","RACE")]
str(datafinal)
```

```{r}
# see the age structure
hist(datafinal$AGE,nclass = 10,xlab = 'age')
```

```{r}
prop.table(table(datafinal$lbfc,datafinal$Disease))
# this table shows that, 28% people are healthy but not in lbfc, 52% of people are healthy and in lbfc; 13% of people are unhealthy and not in lbfc, 4% are unhealthy but still in lbfc.
## so that we can tell, for people who are sick, it is more likely that they are not in lbfc.
```


```{r}
boxplot(datafinal$AGE~datafinal$lbfc)
# this graph shows that the average age of not in lbfc is higher than the average age of people in lbfc.
## it means older people are more likely to be not in lbfc.
```

```{r}
boxplot(datafinal$AGE~datafinal$Disease)
# it means older people are more likely to have health issue.
```

```{r}
# regression analysis
datafinal$Disease=as.factor(datafinal$Disease)
mod=glm(lbfc~.,data=datafinal,family = 'binomial')
summary(mod)
# this means disease and age are infecting people's lbfc statue.
```




















